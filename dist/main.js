(()=>{"use strict";function t(t){let e=t[0],s=t[1],r=t[2];return Math.sqrt(e*e+s*s+r*r)}function e(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function s(t,e,s){return t[0]=e[0]+s[0],t[1]=e[1]+s[1],t[2]=e[2]+s[2],t}function r(t,e,s){return t[0]=e[0]-s[0],t[1]=e[1]-s[1],t[2]=e[2]-s[2],t}function i(t,e,s){return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function n(t){let e=t[0],s=t[1],r=t[2];return e*e+s*s+r*r}function h(t,e){let s=e[0],r=e[1],i=e[2],n=s*s+r*r+i*i;return n>0&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function a(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function l(t,e,s){let r=e[0],i=e[1],n=e[2],h=s[0],a=s[1],l=s[2];return t[0]=i*l-n*a,t[1]=n*h-r*l,t[2]=r*a-i*h,t}const o=function(){const t=[0,0,0],s=[0,0,0];return function(r,i){e(t,r),e(s,i),h(t,t),h(s,s);let n=a(t,s);return n>1?0:n<-1?Math.PI:Math.acos(n)}}();class u extends Array{constructor(t=0,e=t,s=t){return super(t,e,s),this}get x(){return this[0]}get y(){return this[1]}get z(){return this[2]}set x(t){this[0]=t}set y(t){this[1]=t}set z(t){this[2]=t}set(t,e=t,s=t){return t.length?this.copy(t):(function(t,e,s,r){t[0]=e,t[1]=s,t[2]=r}(this,t,e,s),this)}copy(t){return e(this,t),this}add(t,e){return e?s(this,t,e):s(this,this,t),this}sub(t,e){return e?r(this,t,e):r(this,this,t),this}multiply(t){var e,s,r;return t.length?(s=this,r=t,(e=this)[0]=s[0]*r[0],e[1]=s[1]*r[1],e[2]=s[2]*r[2]):i(this,this,t),this}divide(t){var e,s,r;return t.length?(s=this,r=t,(e=this)[0]=s[0]/r[0],e[1]=s[1]/r[1],e[2]=s[2]/r[2]):i(this,this,1/t),this}inverse(t=this){var e,s;return s=t,(e=this)[0]=1/s[0],e[1]=1/s[1],e[2]=1/s[2],this}len(){return t(this)}distance(e){return e?function(t,e){let s=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(s*s+r*r+i*i)}(this,e):t(this)}squaredLen(){return n(this)}squaredDistance(t){return t?function(t,e){let s=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return s*s+r*r+i*i}(this,t):n(this)}negate(t=this){var e,s;return s=t,(e=this)[0]=-s[0],e[1]=-s[1],e[2]=-s[2],this}cross(t,e){return e?l(this,t,e):l(this,this,t),this}scale(t){return i(this,this,t),this}normalize(){return h(this,this),this}dot(t){return a(this,t)}equals(t){return e=t,this[0]===e[0]&&this[1]===e[1]&&this[2]===e[2];var e}applyMatrix3(t){return function(t,e,s){let r=e[0],i=e[1],n=e[2];t[0]=r*s[0]+i*s[3]+n*s[6],t[1]=r*s[1]+i*s[4]+n*s[7],t[2]=r*s[2]+i*s[5]+n*s[8]}(this,this,t),this}applyMatrix4(t){return function(t,e,s){let r=e[0],i=e[1],n=e[2],h=s[3]*r+s[7]*i+s[11]*n+s[15];h=h||1,t[0]=(s[0]*r+s[4]*i+s[8]*n+s[12])/h,t[1]=(s[1]*r+s[5]*i+s[9]*n+s[13])/h,t[2]=(s[2]*r+s[6]*i+s[10]*n+s[14])/h}(this,this,t),this}scaleRotateMatrix4(t){return function(t,e,s){let r=e[0],i=e[1],n=e[2],h=s[3]*r+s[7]*i+s[11]*n+s[15];h=h||1,t[0]=(s[0]*r+s[4]*i+s[8]*n)/h,t[1]=(s[1]*r+s[5]*i+s[9]*n)/h,t[2]=(s[2]*r+s[6]*i+s[10]*n)/h}(this,this,t),this}applyQuaternion(t){return function(t,e,s){let r=e[0],i=e[1],n=e[2],h=s[0],a=s[1],l=s[2],o=a*n-l*i,u=l*r-h*n,d=h*i-a*r,c=a*d-l*u,p=l*o-h*d,g=h*u-a*o,E=2*s[3];o*=E,u*=E,d*=E,c*=2,p*=2,g*=2,t[0]=r+o+c,t[1]=i+u+p,t[2]=n+d+g}(this,this,t),this}angle(t){return o(this,t)}lerp(t,e){return function(t,e,s,r){let i=e[0],n=e[1],h=e[2];t[0]=i+r*(s[0]-i),t[1]=n+r*(s[1]-n),t[2]=h+r*(s[2]-h)}(this,this,t,e),this}clone(){return new u(this[0],this[1],this[2])}fromArray(t,e=0){return this[0]=t[e],this[1]=t[e+1],this[2]=t[e+2],this}toArray(t=[],e=0){return t[e]=this[0],t[e+1]=this[1],t[e+2]=this[2],t}transformDirection(t){const e=this[0],s=this[1],r=this[2];return this[0]=t[0]*e+t[4]*s+t[8]*r,this[1]=t[1]*e+t[5]*s+t[9]*r,this[2]=t[2]*e+t[6]*s+t[10]*r,this.normalize()}}const d=new u;let c=1;class p{constructor({canvas:t=document.createElement("canvas"),width:e=300,height:s=150,dpr:r=1,alpha:i=!1,depth:n=!0,stencil:h=!1,antialias:a=!1,premultipliedAlpha:l=!1,preserveDrawingBuffer:o=!1,powerPreference:u="default",autoClear:d=!0,webgl:p=2}={}){const g={alpha:i,depth:n,stencil:h,antialias:a,premultipliedAlpha:l,preserveDrawingBuffer:o,powerPreference:u};this.dpr=r,this.alpha=i,this.color=!0,this.depth=n,this.stencil=h,this.premultipliedAlpha=l,this.autoClear=d,this.id=c++,2===p&&(this.gl=t.getContext("webgl2",g)),this.isWebgl2=!!this.gl,this.gl||(this.gl=t.getContext("webgl",g)),this.gl||console.error("unable to create webgl context"),this.gl.renderer=this,this.setSize(e,s),this.state={},this.state.blendFunc={src:this.gl.ONE,dst:this.gl.ZERO},this.state.blendEquation={modeRGB:this.gl.FUNC_ADD},this.state.cullFace=null,this.state.frontFace=this.gl.CCW,this.state.depthMask=!0,this.state.depthFunc=this.gl.LESS,this.state.premultiplyAlpha=!1,this.state.flipY=!1,this.state.unpackAlignment=4,this.state.framebuffer=null,this.state.viewport={x:0,y:0,width:null,height:null},this.state.textureUnits=[],this.state.activeTextureUnit=0,this.state.boundBuffer=null,this.state.uniformLocations=new Map,this.state.currentProgram=null,this.extensions={},this.isWebgl2?(this.getExtension("EXT_color_buffer_float"),this.getExtension("OES_texture_float_linear")):(this.getExtension("OES_texture_float"),this.getExtension("OES_texture_float_linear"),this.getExtension("OES_texture_half_float"),this.getExtension("OES_texture_half_float_linear"),this.getExtension("OES_element_index_uint"),this.getExtension("OES_standard_derivatives"),this.getExtension("EXT_sRGB"),this.getExtension("WEBGL_depth_texture"),this.getExtension("WEBGL_draw_buffers")),this.getExtension("WEBGL_compressed_texture_astc"),this.getExtension("EXT_texture_compression_bptc"),this.getExtension("WEBGL_compressed_texture_s3tc"),this.getExtension("WEBGL_compressed_texture_etc1"),this.getExtension("WEBGL_compressed_texture_pvrtc"),this.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),this.vertexAttribDivisor=this.getExtension("ANGLE_instanced_arrays","vertexAttribDivisor","vertexAttribDivisorANGLE"),this.drawArraysInstanced=this.getExtension("ANGLE_instanced_arrays","drawArraysInstanced","drawArraysInstancedANGLE"),this.drawElementsInstanced=this.getExtension("ANGLE_instanced_arrays","drawElementsInstanced","drawElementsInstancedANGLE"),this.createVertexArray=this.getExtension("OES_vertex_array_object","createVertexArray","createVertexArrayOES"),this.bindVertexArray=this.getExtension("OES_vertex_array_object","bindVertexArray","bindVertexArrayOES"),this.deleteVertexArray=this.getExtension("OES_vertex_array_object","deleteVertexArray","deleteVertexArrayOES"),this.drawBuffers=this.getExtension("WEBGL_draw_buffers","drawBuffers","drawBuffersWEBGL"),this.parameters={},this.parameters.maxTextureUnits=this.gl.getParameter(this.gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS),this.parameters.maxAnisotropy=this.getExtension("EXT_texture_filter_anisotropic")?this.gl.getParameter(this.getExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}setSize(t,e){this.width=t,this.height=e,this.gl.canvas.width=t*this.dpr,this.gl.canvas.height=e*this.dpr,Object.assign(this.gl.canvas.style,{width:t+"px",height:e+"px"})}setViewport(t,e,s=0,r=0){this.state.viewport.width===t&&this.state.viewport.height===e||(this.state.viewport.width=t,this.state.viewport.height=e,this.state.viewport.x=s,this.state.viewport.y=r,this.gl.viewport(s,r,t,e))}setScissor(t,e,s=0,r=0){this.gl.scissor(s,r,t,e)}enable(t){!0!==this.state[t]&&(this.gl.enable(t),this.state[t]=!0)}disable(t){!1!==this.state[t]&&(this.gl.disable(t),this.state[t]=!1)}setBlendFunc(t,e,s,r){this.state.blendFunc.src===t&&this.state.blendFunc.dst===e&&this.state.blendFunc.srcAlpha===s&&this.state.blendFunc.dstAlpha===r||(this.state.blendFunc.src=t,this.state.blendFunc.dst=e,this.state.blendFunc.srcAlpha=s,this.state.blendFunc.dstAlpha=r,void 0!==s?this.gl.blendFuncSeparate(t,e,s,r):this.gl.blendFunc(t,e))}setBlendEquation(t,e){t=t||this.gl.FUNC_ADD,this.state.blendEquation.modeRGB===t&&this.state.blendEquation.modeAlpha===e||(this.state.blendEquation.modeRGB=t,this.state.blendEquation.modeAlpha=e,void 0!==e?this.gl.blendEquationSeparate(t,e):this.gl.blendEquation(t))}setCullFace(t){this.state.cullFace!==t&&(this.state.cullFace=t,this.gl.cullFace(t))}setFrontFace(t){this.state.frontFace!==t&&(this.state.frontFace=t,this.gl.frontFace(t))}setDepthMask(t){this.state.depthMask!==t&&(this.state.depthMask=t,this.gl.depthMask(t))}setDepthFunc(t){this.state.depthFunc!==t&&(this.state.depthFunc=t,this.gl.depthFunc(t))}activeTexture(t){this.state.activeTextureUnit!==t&&(this.state.activeTextureUnit=t,this.gl.activeTexture(this.gl.TEXTURE0+t))}bindFramebuffer({target:t=this.gl.FRAMEBUFFER,buffer:e=null}={}){this.state.framebuffer!==e&&(this.state.framebuffer=e,this.gl.bindFramebuffer(t,e))}getExtension(t,e,s){return e&&this.gl[e]?this.gl[e].bind(this.gl):(this.extensions[t]||(this.extensions[t]=this.gl.getExtension(t)),e?this.extensions[t]?this.extensions[t][s].bind(this.extensions[t]):null:this.extensions[t])}sortOpaque(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program.id!==e.program.id?t.program.id-e.program.id:t.zDepth!==e.zDepth?t.zDepth-e.zDepth:e.id-t.id}sortTransparent(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.zDepth!==e.zDepth?e.zDepth-t.zDepth:e.id-t.id}sortUI(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program.id!==e.program.id?t.program.id-e.program.id:e.id-t.id}getRenderList({scene:t,camera:e,frustumCull:s,sort:r}){let i=[];if(e&&s&&e.updateFrustum(),t.traverse((t=>{if(!t.visible)return!0;t.draw&&(s&&t.frustumCulled&&e&&!e.frustumIntersectsMesh(t)||i.push(t))})),r){const t=[],s=[],r=[];i.forEach((i=>{i.program.transparent?i.program.depthTest?s.push(i):r.push(i):t.push(i),i.zDepth=0,0===i.renderOrder&&i.program.depthTest&&e&&(i.worldMatrix.getTranslation(d),d.applyMatrix4(e.projectionViewMatrix),i.zDepth=d.z)})),t.sort(this.sortOpaque),s.sort(this.sortTransparent),r.sort(this.sortUI),i=t.concat(s,r)}return i}render({scene:t,camera:e,target:s=null,update:r=!0,sort:i=!0,frustumCull:n=!0,clear:h}){null===s?(this.bindFramebuffer(),this.setViewport(this.width*this.dpr,this.height*this.dpr)):(this.bindFramebuffer(s),this.setViewport(s.width,s.height)),(h||this.autoClear&&!1!==h)&&(!this.depth||s&&!s.depth||(this.enable(this.gl.DEPTH_TEST),this.setDepthMask(!0)),this.gl.clear((this.color?this.gl.COLOR_BUFFER_BIT:0)|(this.depth?this.gl.DEPTH_BUFFER_BIT:0)|(this.stencil?this.gl.STENCIL_BUFFER_BIT:0))),r&&t.updateMatrixWorld(),e&&e.updateMatrixWorld(),this.getRenderList({scene:t,camera:e,frustumCull:n,sort:i}).forEach((t=>{t.draw({camera:e})}))}}new class{constructor(){this.createRenderer()}createRenderer(){this.renderer=new p({alpha:!0}),this.gl=this.renderer.gl,console.log("Renderer"),document.body.append(this.gl.canvas)}},console.log("Working!")})();